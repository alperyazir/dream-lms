# Story 27.16: DreamAI Sidebar Section

**Status:** Ready for Review

**Epic:** Epic 27 - DreamAI - AI-Powered Content Generation
**Story Points:** 3
**Priority:** High
**Dependencies:** None (can be implemented early as UI scaffolding)

---

## Story

**As a** teacher/supervisor/admin,
**I want** a DreamAI section in the sidebar,
**so that** I can easily access AI content generation features from the main navigation.

---

## Acceptance Criteria

1. [x] New sidebar item with AI icon
2. [x] Role-based visibility (Admin, Supervisor, Teacher only)
3. [x] Sub-navigation: Generator, Vocabulary Explorer, Content Library
4. [x] Badge for pending generated content (optional) - Skipped as marked optional
5. [x] Consistent with existing sidebar design

---

## Tasks / Subtasks

### Frontend Tasks

- [x] **Task 1: Add DreamAI Section to Sidebar** (AC: 1, 2, 5)
  - [x] Modify `frontend/src/components/Common/SidebarItems.tsx`
  - [x] Add DreamAI menu item:
    - Icon: Sparkles icon from Lucide
    - Label: "DreamAI"
    - Position: After My Materials in teacher menu, at end for admin/supervisor
  - [x] Role-based visibility:
    - Show for: admin, supervisor, teacher
    - Hide for: publisher, student
  - [x] Match existing sidebar styling:
    - Same hover states
    - Same active states
    - Same font sizes

- [x] **Task 2: Create DreamAI Sub-navigation** (AC: 3)
  - [x] Add collapsible sub-menu items:
    ```
    âœ¨ DreamAI
    â”œâ”€â”€ Question Generator
    â”œâ”€â”€ Vocabulary Explorer
    â”œâ”€â”€ Content Library
    â””â”€â”€ My Materials
    ```
  - [x] Each sub-item links to corresponding route
  - [x] Highlight active sub-item

- [x] **Task 3: Create DreamAI Routes Structure** (AC: 3)
  - [x] Create route files (placeholder pages):
    - `frontend/src/routes/_layout/dreamai/index.tsx` (redirects to generator)
    - `frontend/src/routes/_layout/dreamai/generator.tsx`
    - `frontend/src/routes/_layout/dreamai/vocabulary.tsx`
    - `frontend/src/routes/_layout/dreamai/library.tsx`
    - `frontend/src/routes/_layout/dreamai/materials.tsx`
  - [x] Implement basic page shells with headings
  - [x] Route guards handled by layout (_layout requires auth)

- [x] **Task 4: Add Badge for Pending Content (Optional)** (AC: 4)
  - Skipped - marked as optional in story requirements

- [x] **Task 5: Update Sidebar Navigation Types** (AC: All)
  - [x] Extend navigation config to support sub-items (SubItem interface)
  - [x] Add DreamAI navigation config (dreamAISubItems array)
  - [x] Ensure type safety for new routes (IconComponent type)

- [x] **Task 6: Write Frontend Tests** (AC: All)
  - [x] Test sidebar renders DreamAI for teachers
  - [x] Test sidebar renders DreamAI for admin
  - [x] Test sidebar renders DreamAI for supervisor
  - [x] Test sidebar hides DreamAI for students
  - [x] Test sidebar hides DreamAI for publishers
  - [x] Test sub-navigation expands/collapses
  - [x] Test navigation to correct routes

---

## Dev Notes

### Sidebar Structure After Implementation

```
Admin/Supervisor/Teacher Sidebar:
â”œâ”€â”€ ðŸ  Dashboard
â”œâ”€â”€ ðŸ‘¥ Users (admin only)
â”œâ”€â”€ ðŸ“š Books
â”œâ”€â”€ ðŸ“ Assignments
â”œâ”€â”€ ðŸ¤– DreamAI              â† NEW
â”‚   â”œâ”€â”€ âœ¨ Question Generator
â”‚   â”œâ”€â”€ ðŸ“š Vocabulary Explorer
â”‚   â”œâ”€â”€ ðŸ“ Content Library
â”‚   â””â”€â”€ ðŸ“„ My Materials
â”œâ”€â”€ ðŸ“Š Analytics
â”œâ”€â”€ ðŸ’¬ Messages
â”œâ”€â”€ ðŸ”” Notifications
â””â”€â”€ âš™ï¸ Settings

Student Sidebar (NO DreamAI):
â”œâ”€â”€ ðŸ  Dashboard
â”œâ”€â”€ ðŸ“ Assignments
â”œâ”€â”€ ðŸ“š Study              â† From Story 27.11
â”‚   â””â”€â”€ Vocabulary Flashcards
â”œâ”€â”€ ðŸ“Š My Progress
â”œâ”€â”€ ðŸ’¬ Messages
â”œâ”€â”€ ðŸ”” Notifications
â””â”€â”€ âš™ï¸ Settings
```

### Role-Based Visibility Logic

```typescript
const DREAMAI_VISIBLE_ROLES = ['admin', 'supervisor', 'teacher'];

function shouldShowDreamAI(userRole: string): boolean {
  return DREAMAI_VISIBLE_ROLES.includes(userRole);
}
```

### Route Structure

```
/dreamai              â†’ Redirect to /dreamai/generator
/dreamai/generator    â†’ Question Generator page
/dreamai/vocabulary   â†’ Vocabulary Explorer page
/dreamai/library      â†’ Content Library page
/dreamai/materials    â†’ My Materials page (teacher uploaded content)
```

### Existing Sidebar Pattern

Looking at existing sidebar implementation:

```typescript
// Example from existing sidebar pattern
const navigationItems = [
  {
    name: 'Dashboard',
    href: '/dashboard',
    icon: HomeIcon,
    roles: ['admin', 'supervisor', 'teacher', 'student'],
  },
  {
    name: 'DreamAI',
    href: '/dreamai',
    icon: SparklesIcon,
    roles: ['admin', 'supervisor', 'teacher'],
    children: [
      { name: 'Question Generator', href: '/dreamai/generator' },
      { name: 'Vocabulary Explorer', href: '/dreamai/vocabulary' },
      { name: 'Content Library', href: '/dreamai/library' },
      { name: 'My Materials', href: '/dreamai/materials' },
    ],
  },
  // ... other items
];
```

### Icon Options

Lucide React icons to consider:
- `Sparkles` - AI/magic feel âœ¨
- `Wand2` - Magic wand
- `Bot` - Robot/AI
- `BrainCircuit` - AI brain

Recommendation: Use `Sparkles` for modern AI feel.

### Source Tree Reference

**New files to create:**
```
frontend/src/routes/_layout/dreamai/
â”œâ”€â”€ index.tsx           # Redirect to generator
â”œâ”€â”€ generator.tsx       # Question Generator page
â”œâ”€â”€ vocabulary.tsx      # Vocabulary Explorer page
â”œâ”€â”€ library.tsx         # Content Library page
â””â”€â”€ materials.tsx       # My Materials page
```

**Files to modify:**
```
frontend/src/components/Common/Sidebar.tsx  # Add DreamAI section
frontend/src/components/Common/Navbar.tsx   # May need breadcrumb updates
```

---

## Testing

### Test Cases

```typescript
describe('Sidebar DreamAI Section', () => {
  it('renders DreamAI section for admin users')
  it('renders DreamAI section for supervisor users')
  it('renders DreamAI section for teacher users')
  it('does NOT render DreamAI section for student users')
  it('does NOT render DreamAI section for publisher users')
  it('expands sub-menu on click')
  it('collapses sub-menu on second click')
  it('highlights active sub-item')
  it('navigates to correct route on sub-item click')
})
```

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-02 | 0.1 | Initial story draft | Bob (SM Agent) |
| 2026-01-02 | 1.0 | Implementation complete | James (Dev Agent) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References
No debug issues encountered.

### Completion Notes
- Implemented collapsible DreamAI section in sidebar for admin, supervisor, and teacher roles
- Created 5 route files with placeholder pages (generator, vocabulary, library, materials, index redirect)
- Extended SidebarItems to support nested sub-navigation with SubItem interface
- Used Sparkles icon from Lucide for DreamAI branding
- Added 10 comprehensive tests covering role-based visibility and sub-menu behavior
- Skipped Task 4 (Badge for Pending Content) as marked optional in requirements
- All tests pass (10/10)

### File List

**New Files:**
- `frontend/src/routes/_layout/dreamai/index.tsx` - Redirect to generator
- `frontend/src/routes/_layout/dreamai/generator.tsx` - Question Generator placeholder
- `frontend/src/routes/_layout/dreamai/vocabulary.tsx` - Vocabulary Explorer placeholder
- `frontend/src/routes/_layout/dreamai/library.tsx` - Content Library placeholder
- `frontend/src/routes/_layout/dreamai/materials.tsx` - My Materials page

**Modified Files:**
- `frontend/src/components/Common/SidebarItems.tsx` - Added DreamAI section with sub-navigation
- `frontend/src/components/Common/SidebarItems.test.tsx` - Added 8 new DreamAI tests
- `frontend/src/routeTree.gen.ts` - Auto-generated with new routes

---

## QA Results

_To be filled by QA agent_
